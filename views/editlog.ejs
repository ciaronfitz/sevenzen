<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>SEVENZEN</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="icon" href="/sevenzen.ico" sizes="any" type="image/svg+xml">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="stylesheet" href="/mystyles.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
        integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>

<body>
    <%- include('header'); %>
        <% for (let row of details) { %>
            <% var emoid=row.emotion_log_id; %>
                <% var emointensity=row.emotion_intensity; %>
                    <% var enjoyment=row.enjoyment; %>
                        <% var triggers=triggers; %>
                            <% var user_notes=row.user_notes; %>
                                <% var logdate=row.time_stamp; %>
                                    <% var inputdate=new Date(logdate); %>
                                        <% const year=inputdate.getFullYear(); %>
                                            <% const month=(inputdate.getMonth() + 1).toString().padStart(2, "0" ); %>
                                                <% const day=inputdate.getDate().toString().padStart(2, "0" ); %>
                                                    <% var formattedDate=`${year}-${month}-${day}` ; %>
                                                        <% } %>
                                                            <main class="main">
                                                                <div class="container text-center">
                                                                    <form method="post" action="/edit/<%=emoid%>">
                                                                        <div class="accordion accordion-flush"
                                                                            id="accordionFlushExample">
                                                                            <div class="accordion-item">
                                                                                <h2 class="accordion-header">
                                                                                    <button
                                                                                        class="accordion-button collapsed"
                                                                                        type="button"
                                                                                        data-bs-toggle="collapse"
                                                                                        data-bs-target="#flush-collapseOne"
                                                                                        aria-expanded="false"
                                                                                        aria-controls="flush-collapseOne">
                                                                                        Enjoyment
                                                                                    </button>
                                                                                </h2>
                                                                                <div id="flush-collapseOne"
                                                                                    class="accordion-collapse collapse"
                                                                                    data-bs-parent="#accordionFlushExample">
                                                                                    <div class="accordion-body">
                                                                                        <label for="enjoyment"
                                                                                            class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                            intense is the
                                                                                            emotion?</label>
                                                                                        <input type="range"
                                                                                            name="enjoyment"
                                                                                            class="range" min="1"
                                                                                            max="10" step="1"
                                                                                            id="enjoyment"
                                                                                            value="<%=details[0].enjoyment%>">
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseTwo"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseTwo">
                                                                                            Sadness
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseTwo"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="sadness"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="sadness"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="sadness"
                                                                                                value="<%=details[0].sadness%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseThree"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseThree">
                                                                                            Anger
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseThree"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="anger"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="anger"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="anger"
                                                                                                value="<%=details[0].anger%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseFour"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseFour">
                                                                                            Contempt
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseFour"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="contepmt"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="contempt"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="contempt"
                                                                                                value="<%=details[0].contempt%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseFive"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseFive">
                                                                                            Disgust
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseFive"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="disgust"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="disgust"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="disgust"
                                                                                                value="<%=details[0].disgust%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseSix"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseSix">
                                                                                            Fear
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseSix"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="fear"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="fear"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="fear"
                                                                                                value="<%=details[0].fear%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseSeven"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseSeven">
                                                                                            Surprise
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseSeven"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label for="surprise"
                                                                                                class="form-label ml-3 mr-3 pt-3 pb-3">How
                                                                                                intense is the
                                                                                                emotion?</label>
                                                                                            <input type="range"
                                                                                                name="surprise"
                                                                                                class="range" min="1"
                                                                                                max="10" step="1"
                                                                                                id="surprise"
                                                                                                value="<%=details[0].surprise%>">
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseEight"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseEight">
                                                                                            Triggers <span
                                                                                                id="triggererror"></span>
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseEight"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <label>What has triggered
                                                                                                this?
                                                                                                (You
                                                                                                can choose more than one
                                                                                                trigger)</label>
                                                                                            <div class="row">
                                                                                                <% selecttriggers.forEach((row,
                                                                                                    index)=> { %>
                                                                                                    <div
                                                                                                        class="col-6 col-md-4 col-lg-3">
                                                                                                        <div class="btn"
                                                                                                            role="group"
                                                                                                            name="triggers"
                                                                                                            aria-label="Basic checkbox toggle button group">
                                                                                                            <input
                                                                                                                type="checkbox"
                                                                                                                class="btn-check"
                                                                                                                id="btncheck<%= index + 1 %>"
                                                                                                                name="trigger"
                                                                                                                value="<%= row.emotrigger_name %>"
                                                                                                                autocomplete="off"
                                                                                                                <%=triggers.includes(row.emotrigger_name)
                                                                                                                ? 'checked'
                                                                                                                : '' %>>
                                                                                                            <label
                                                                                                                class="btn btn-outline-primary"
                                                                                                                for="btncheck<%= index + 1 %>">
                                                                                                                <%= row.emotrigger_name
                                                                                                                    %>
                                                                                                            </label>
                                                                                                        </div>
                                                                                                    </div>
                                                                                                    <% }); %>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="accordion-item">
                                                                                    <h2 class="accordion-header">
                                                                                        <button
                                                                                            class="accordion-button collapsed"
                                                                                            type="button"
                                                                                            data-bs-toggle="collapse"
                                                                                            data-bs-target="#flush-collapseNine"
                                                                                            aria-expanded="false"
                                                                                            aria-controls="flush-collapseNine">
                                                                                            Notes
                                                                                        </button>
                                                                                    </h2>
                                                                                    <div id="flush-collapseNine"
                                                                                        class="accordion-collapse collapse"
                                                                                        data-bs-parent="#accordionFlushExample">
                                                                                        <div class="accordion-body">
                                                                                            <div
                                                                                                class="form-group  ml-3 mr-3 pt-3 pb-3">
                                                                                                <label
                                                                                                    for="exampleFormControlTextarea1">Personal
                                                                                                    Notes</label>
                                                                                                <textarea
                                                                                                    class="form-control"
                                                                                                    name="usernotes"
                                                                                                    id="exampleFormControlTextarea1"
                                                                                                    rows="3"
                                                                                                    placeholder="<%=user_notes%>"></textarea>
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                            <button type="submit"
                                                                                class="btn btn-primary ml-3 mr-3 pt-3 pb-3">Submit</button>
                                                                    </form>
                                                                </div>
                                                            </main>
                                                            <script>
                                                                //check at least one trigger has been selected
                                                                $(document).ready(function () {
                                                                    $("form").submit(function (event) {
                                                                        var triggers = $("input[name='trigger']:checked").length;
                                                                        if (triggers < 1) {
                                                                            $("#triggererror").text("Please select at least one trigger.")
                                                                                .css('color', 'red')
                                                                                .show();
                                                                            event.preventDefault();
                                                                        }
                                                                    });
                                                                });
                                                            </script>
</body>
</html>